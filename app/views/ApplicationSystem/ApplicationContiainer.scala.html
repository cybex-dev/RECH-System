@import views.html.Templates.Masterpage
@import org.w3c.dom.Document
@import controllers.ApplicationSystem.XMLParser
@import b4._
@import models.ApplicationSystem.EthicsApplication
@import play.data.Form
@import scala.xml.Node
@import org.w3c.dom.Element

@import views.html.helper.FieldConstructor
@(pageTitle: String)(applicationType: String)(root: Element)(form: DynamicForm)

@{

}

@contentBlock = {
    <h1>Create Ethics Application for @applicationType Research</h1>
    <br>
    <div id="wizard-container">
        <div id="wizard-header">

        </div>
        <div id="wizard-body-container">
            <div id="wizard-progress-container">

            </div>
            <div id="wizard-body">
                <p>
                @{
                    def parser(node: Node)(implicit fc: vertical.VerticalFieldConstructor): Html = {
                        node.label match {
                            case "section" => "<p></p>".asInstanceOf[Html]
                            case "group" =>  "<p></p>".asInstanceOf[Html]
                            case "extension" => "<p></p>".asInstanceOf[Html]
                            case "component" =>
                                val comp_type = node.attribute("type").get.head.label
                                comp_type match {
                                    case "boolean" => b4.checkbox(form(node.attribute("id").get.head.label), '_label -> node.child.head.label)
                                    case "text" => b4.text(form(node.attribute("id").get.head.label), '_label -> node.child.head.label)
                                    case "number" => b4.text(form(node.attribute("id").get.head.label), '_label -> node.child.head.label)
                                }
                            case "list" => "<p></p>".asInstanceOf[Html]
                            case "question" => "<p></p>".asInstanceOf[Html]
                            case "value" => "<p></p>".asInstanceOf[Html]
                        }
                    }

                    b4.vertical.form(controllers.ApplicationSystem.routes.ApplicationHandler.newApplication()) { implicit vfc =>
                        parser(root.asInstanceOf[Node])(vfc)
                    }
                }
                </p>
            </div>
        </div>
    </div>
}

@Masterpage.apply(pageTitle)(contentBlock)
