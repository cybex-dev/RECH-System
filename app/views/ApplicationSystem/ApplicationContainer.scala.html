@import java.util
@import models.ApplicationSystem.Question
@import net.ddns.cyberstudios.Element
@import play.data.DynamicForm
@import play.twirl.api.Html
@import views.html.Templates.Masterpage
@import views.html.ApplicationSystem
@import views.html.Components.ActionButton
@import views.html.Components.ActionButtons
@import dao.ApplicationSystem.EntityEthicsApplicationPK
@import controllers.APIController
@import helpers._
@import play.api.mvc.Call
@import models.ApplicationSystem.EthicsApplication.ApplicationType
@import models.ApplicationSystem.EthicsApplication
@import net.ddns.cyberstudios.Element

@import views.html.Components.reviewable
@(pageTitle: String)(applicationType: ApplicationType)(root: Element)(editableMap: util.Map[String, Boolean])(showQuestions: Boolean)(applicationId: String)(feedback: Boolean)(review: Boolean)(reviewDataMap: util.Map[String, util.List[String]])(negativeButton: GuiButton)(positiveButton: GuiButton = null)(neutralButton: GuiButton = null)

@upper(txt: String) = @{
    txt.substring(0, 1).toUpperCase() + txt.substring(1).toLowerCase()
}

@Masterpage.apply(pageTitle) {

    <div class="BoxMediumBlue" style="padding: 20px;">
        <div class="container-heading">
            <h1>Create Ethics Application for @{upper(applicationType.name())} Research</h1>
        </div>
        <br/>
        <div class="row">
            @if(!feedback && !review) {
                <h5 style="font-style: italic; margin-left: 20px">Please complete the application form provided below.</h5>
                <h5 style="font-style: italic; margin-left: 20px"> If you have trouble answering a question, hover over these icons <ic title="This is a hint. It provides context to a quesiton" class="fa fa-question-circle helper-hint"></ic> which provide additional information for answering a question.</h5>
                <br/>
            }
            <div class="col-sm-12">
            @helper.form(action = positiveButton.getCallBack, 'enctype -> "multipart/form-data", 'id -> "application_form") {
                @helper.CSRF.formField
                <input type="hidden" value="" id="application_level" name="application_level">
                <input type="hidden" value="false" id="application_questions_shown" name="application_questions_shown">
                <input type="hidden" value="@applicationType.name()" id="application_type" name="application_type">
                <input type="hidden" value="@applicationId" id="application_id" name="application_id">
                @ApplicationSystem.fragmentApplicationContainer.apply(root: Element)(editableMap: util.Map[String, Boolean])(feedback: Boolean)(review: Boolean)(reviewDataMap: util.Map[String, util.List[String]])
                <br>
                @if(feedback) {
                    <script src="@routes.Assets.versioned("javascripts/reviewer.js")" type="text/javascript"></script>
                }
            }
            </div>
        </div>
        <div class="row">
            @ActionButtons.apply{
                @if(negativeButton != null) {
                    @ActionButton.apply(negativeButton)(false)()()
                }
            } {
                @if(neutralButton != null) {
                    @ActionButton.apply(neutralButton)(true)()()
                }
            } {
                @if(positiveButton != null) {
                    @ActionButton.apply(positiveButton)(false)()()
                }
            }
        </div>
        @if(showQuestions) {
            @ApplicationSystem.fragmentFilterQuestions.apply(EthicsApplication.GetQuestionList(applicationType))
        } else {}
    </div>

}
